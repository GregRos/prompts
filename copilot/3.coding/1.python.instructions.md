---
applyTo: "**/*.py"
---
# Python rules
> % ONLY APPLY
> - when writing python code.
> - you are in agent mode.
## Tooling
- Use poetry.
- Pyright must be installed as a dev dependency.
- %MUST check there are no type errors, such as by executing pyright.
- %ONLY use pyright config in `project.toml` and not `.vscode`
## Type hints

### Generics

- %ONLY use `list`, `dict`, and `tuple` rather than `List` etc.
- %ONLY use `T | None` and not `Optional[T]`
- %ONLY use `T1 | T2` and not `Union[T1, T2]`
#### %ONLY use new style generics
This is the old style:

```python
T = TypeVar('T')
def func(x: list[T]) -> dict[str, T]:
    ...
class MyClass(Generic[T]):
    ...    
```

You should instead:

```python
def func[T](x: list[T]) -> dict[str, T]:
    ...
class MyClass[T]:
    ...
```

### Function parameters
- %ONLY declare parameters with type hints.
### Attributes of classes
- %ONLY define attributes with type hints.
- ALWAYS DO: For optional attributes, use `T | None = None`.
- ALWAYS DO: For attributes with default values, use the type of the default value.

### Class declaration

- ALWAYS DO: Use `@dataclass` for classes unless they require custom `__init__`.
-

### When to use

- PARAMETERS of functions and methods.
- ATTRIBUTES of classes.
